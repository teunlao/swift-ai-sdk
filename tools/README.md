# Swift Test Runner

–ì–∏–±–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Swift —Ç–µ—Å—Ç–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ç–µ—Å—Ç–æ–≤ (1000+) —Å–ª–æ–∂–Ω–æ:
- –ù–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≤–∏—Å–∞–Ω–∏–∏
- –í—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –≥—Ä—É–ø–ø—É —Ç–µ—Å—Ç–æ–≤
- –ù–µ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏ –Ω–µ —É–¥–∞–ª—è—Ç—å —Ç–µ—Å—Ç—ã

## –†–µ—à–µ–Ω–∏–µ

Node.js —Å–∫—Ä–∏–ø—Ç —Å JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –¥–ª—è –≥–∏–±–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–æ–º —Ç–µ—Å—Ç–æ–≤.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd tools
chmod +x test-runner.js
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥**:
```bash
./test-runner.js --init
```

2. **–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã**:
```bash
./test-runner.js --list
```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å —Ç–µ–∫—É—â–∏–º –∫–æ–Ω—Ñ–∏–≥–æ–º**:
```bash
./test-runner.js
```

## –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### 1. –ò—Å–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç—ã (exclude)

–ó–∞–ø—É—Å—Ç–∏—Ç—å **–í–°–ï —Ç–µ—Å—Ç—ã –ö–†–û–ú–ï** —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ —Å–ø–∏—Å–∫–µ:

```json
{
  "mode": "exclude",
  "tests": [
    "SwiftAISDKTests.HandleUIMessageStreamFinishTests/*",
    "SwiftAISDKTests.ReadUIMessageStreamTests/*",
    "*.CreateUIMessageStreamTests/mergesMultipleStreams"
  ],
  "parallel": true
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –í—ã—á–ª–µ–Ω–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≤–∏—Å–∞–Ω–∏–∏.

### 2. –í–∫–ª—é—á–∏—Ç—å —Ç–æ–ª—å–∫–æ (include)

–ó–∞–ø—É—Å—Ç–∏—Ç—å **–¢–û–õ–¨–ö–û** —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:

```json
{
  "mode": "include",
  "tests": [
    "AISDKProviderTests.*",
    "SwiftAISDKTests.DelayTests/*"
  ],
  "parallel": false
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

### 3. –ü–æ—Å–ª–µ–¥–Ω–∏–µ N —Ç–µ—Å—Ç–æ–≤ (last)

```json
{
  "mode": "last",
  "count": 50,
  "parallel": true
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ë—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã.

### 4. –ü–µ—Ä–≤—ã–µ N —Ç–µ—Å—Ç–æ–≤ (first)

```json
{
  "mode": "first",
  "count": 100,
  "parallel": false
}
```

### 5. –í—Å–µ —Ç–µ—Å—Ç—ã (all)

```json
{
  "mode": "all",
  "parallel": true,
  "verbose": true
}
```

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### Wildcard —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:

- `*` - –ª—é–±–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤
- `?` - –æ–¥–∏–Ω –ª—é–±–æ–π —Å–∏–º–≤–æ–ª
- `.` - —Ç–æ—á–∫–∞ (—ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### –ü—Ä–∏–º–µ—Ä—ã:

```json
{
  "tests": [
    // –í–µ—Å—å test suite
    "SwiftAISDKTests.HandleUIMessageStreamFinishTests/*",

    // –í—Å–µ —Ç–µ—Å—Ç—ã –≤–æ –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–∞—Ö —Å –∏–º–µ–Ω–µ–º CreateUIMessageStreamTests
    "*.CreateUIMessageStreamTests/*",

    // –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
    "SwiftAISDKTests.DelayTests/delayWithSignal",

    // –í—Å–µ —Ç–µ—Å—Ç—ã —Å "Finish" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ suite
    "*Finish*/*",

    // –í—Å–µ —Ç–µ—Å—Ç—ã –≤ –ø–∞–∫–µ—Ç–µ AISDKProviderTests
    "AISDKProviderTests.*"
  ]
}
```

## –û–ø—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–∞

```json
{
  "mode": "exclude",           // exclude, include, all, last, first
  "tests": ["pattern1", "..."], // –ú–∞—Å—Å–∏–≤ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
  "parallel": true,             // –ó–∞–ø—É—Å–∫ –≤ parallel —Ä–µ–∂–∏–º–µ
  "verbose": false,             // –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
  "count": 20                   // –î–ª—è —Ä–µ–∂–∏–º–æ–≤ last/first
}
```

## –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å
./test-runner.js --help

# –°–æ–∑–¥–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
./test-runner.js --init

# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
./test-runner.js --list

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º
./test-runner.js --config my-config.json

# Dry run (–ø–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ)
./test-runner.js --dry-run

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
./test-runner.js
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ù–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≤–∏—Å–∞–Ω–∏–∏

1. –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏:

```json
{
  "mode": "exclude",
  "tests": [
    "SwiftAISDKTests.HandleUIMessageStreamFinishTests/*",
    "SwiftAISDKTests.ReadUIMessageStreamTests/*"
  ],
  "parallel": true
}
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
./test-runner.js
```

3. –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö
4. –ï—Å–ª–∏ –∑–∞–≤–∏—Å–ª–æ - –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ —Ç–µ—Å—Ç—ã –≤ —Å–ø–∏—Å–æ–∫

### –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

```json
{
  "mode": "include",
  "tests": [
    "SwiftAISDKTests.UIMessage*"
  ],
  "parallel": false,
  "verbose": true
}
```

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

```json
{
  "mode": "last",
  "count": 30,
  "parallel": true
}
```

## –û—Ç–ª–∞–¥–∫–∞

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ:

```bash
./test-runner.js --dry-run
```

–í—ã–≤–æ–¥:
```
üìä Test Runner Summary
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Mode:           exclude
Total tests:    763
Selected tests: 750
Excluded:       13
Parallel:       Yes
Patterns:       2
  - SwiftAISDKTests.HandleUIMessageStreamFinishTests/*
  - SwiftAISDKTests.ReadUIMessageStreamTests/*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîç Tests to run:
  AISDKProviderTests.LanguageModelV2CallOptionsTests/full()
  AISDKProviderTests.LanguageModelV2CallOptionsTests/minimal()
  ...
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã:

```bash
./test-runner.js --list | grep "UIMessage"
```

## –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:

```bash
# –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ UI —Ç–µ—Å—Ç–æ–≤
tools/config-ui-tests.json

# –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞
tools/config-quick.json

# –ö–æ–Ω—Ñ–∏–≥ –¥–ª—è CI
tools/config-ci.json
```

–ó–∞–ø—É—Å–∫:
```bash
./test-runner.js --config config-ui-tests.json
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI

```yaml
# .github/workflows/test.yml
- name: Run tests with exclusions
  run: |
    cd tools
    ./test-runner.js --config config-ci.json
```

## –°–æ–≤–µ—Ç—ã

1. **–ë–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤**: –ò—Å–∫–ª—é—á–∞–π—Ç–µ –ø–æ–ª–æ–≤–∏–Ω—É —Ç–µ—Å—Ç–æ–≤, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–π
2. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ä–∞–±–æ—á–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏**: –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ --dry-run**: –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º
4. **–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —Å grep**: `./test-runner.js --list | grep "Pattern"`

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: —Ç–µ—Å—Ç—ã –∑–∞–≤–∏—Å–∞—é—Ç

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å `--dry-run` —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–ø–∏—Å–æ–∫
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `mode: "exclude"` —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ
3. –ë–∏–Ω–∞—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º –Ω–∞–π–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–π —Ç–µ—Å—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `*` –¥–ª—è wildcard
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--dry-run` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ—á–Ω–æ–µ –∏–º—è —á–µ—Ä–µ–∑ `--list`

### –ü—Ä–æ–±–ª–µ–º–∞: —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤ –≤ —Ñ–∏–ª—å—Ç—Ä–µ

–°–∫—Ä–∏–ø—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—É –≥—Ä—É–ø–ø–∏—Ä—É—è –ø–æ suite. –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
- –†–∞–∑–±–µ–π—Ç–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

## License

MIT
